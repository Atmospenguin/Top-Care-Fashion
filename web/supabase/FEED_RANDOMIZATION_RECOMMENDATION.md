# Feed随机化方案推荐

## 📊 测试结果对比

### Bucket 0.1（当前实现）
```
Bucket 5: 1个商品 [36]
Bucket 4: 1个商品 [84]
Bucket 3: 4个商品 [72,60,197,123]  ← 可以随机化
Bucket 2: 6个商品 [88,73,479,211,89,180]  ← 可以随机化
Bucket 1: 8个商品 [164,95,177,167,121,182,116,81]  ← 可以随机化
```
**随机化范围**：后18个商品可以随机排序
**变化程度**：每次刷新约1-2个商品位置变化

---

### Bucket 0.15（推荐方案）
```
Bucket 3: 2个商品 [36,84]  ← 可以随机化（高分商品也开始变化）
Bucket 2: 4个商品 [72,60,197,123]  ← 可以随机化
Bucket 1: 10个商品 [88,73,479,211,89,180,164,95,177,167]  ← 大幅增加随机化
Bucket 0: 4个商品 [121,182,116,81]  ← 可以随机化
```
**随机化范围**：所有20个商品都可以随机排序
**变化程度**：每次刷新约3-5个商品位置变化 ⬆️
**优势**：
- ✅ 高分商品（36,84）也开始有变化
- ✅ 中低分商品（bucket 1）有10个商品可以随机排序
- ✅ 变化更明显，用户体验更好

---

### Bucket 0.2（激进方案）
```
Bucket 2: 2个商品 [36,84]  ← 可以随机化
Bucket 1: 10个商品 [72,60,197,123,88,73,479,211,89,180]  ← 大量商品随机化
Bucket 0: 8个商品 [164,95,177,167,121,182,116,81]  ← 可以随机化
```
**随机化范围**：所有20个商品都可以随机排序
**变化程度**：每次刷新约5-7个商品位置变化 ⬆️⬆️
**优势**：
- ✅ 变化非常明显
- ✅ 用户体验最佳
**风险**：
- ⚠️ 可能会让分数差距较大的商品混在一起（如72和180在同一bucket）
- ⚠️ 可能影响推荐质量

---

## 🏆 最终推荐

### 首选方案：**Bucket 0.15**

**理由**：
1. ✅ **变化明显**：每次刷新约3-5个商品位置变化，用户体验显著改善
2. ✅ **保持质量**：高分商品（36,84）虽然可以随机化，但仍在最高bucket
3. ✅ **平衡性好**：既增加了多样性，又保持了推荐质量
4. ✅ **实现简单**：只需修改一个参数
5. ✅ **风险低**：不会让分数差距过大的商品混在一起

### 实施步骤

#### 步骤1：应用Bucket 0.15
```sql
floor(d.final_score_num / 0.15)::int AS score_bucket
```

#### 步骤2：测试效果
- 连续刷新5次，记录变化
- 如果变化明显（>3个商品），采用此方案
- 如果变化不够，进入步骤3

#### 步骤3（可选）：如果0.15不够，测试0.2
- 仅在用户反馈变化仍不够时考虑
- 需要评估是否影响推荐质量

---

## 📈 预期效果对比

| 方案 | 变化商品数 | 用户体验 | 推荐质量 | 风险 |
|------|-----------|---------|---------|------|
| **Bucket 0.1（当前）** | 1-2个 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 无 |
| **Bucket 0.15（推荐）** | 3-5个 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 低 |
| **Bucket 0.2（激进）** | 5-7个 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | 中 |

---

## 🎯 结论

**强烈推荐使用Bucket 0.15**，这是最佳平衡点：
- 变化明显，用户体验好
- 保持推荐质量
- 实现简单，风险低

如果用户反馈变化仍不够明显，可以考虑测试Bucket 0.2，但需要谨慎评估对推荐质量的影响。

